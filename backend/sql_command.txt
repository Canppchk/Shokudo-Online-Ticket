CREATE DATABASE IF NOT EXISTS sot;
USE sot;

------------------------------------------
Food TABLE

CREATE TABLE IF NOT EXISTS Food (
    Id INT AUTO_INCREMENT PRIMARY KEY,
    Name VARCHAR(255) NOT NULL,
    Meal VARCHAR(255) NOT NULL,
    Detail TEXT,
    Stock INT NOT NULL,
    Price DECIMAL(10, 2) NOT NULL,
    Picture LONGTEXT
);

INSERT INTO Food (Name, Meal, Detail, Stock, Price, Picture) VALUES
('Grilled Chicken', 'Dinner', 'Delicious grilled chicken with herbs', 20, 12.99, 'base64-encoded-image-string'),
('Vegetable Pasta', 'Lunch', 'Healthy vegetable pasta with a light sauce', 15, 8.50, 'base64-encoded-image-string'),
('Beef Burger', 'Lunch', 'Juicy beef burger with cheese and lettuce', 10, 11.00, 'base64-encoded-image-string'),
('Seafood Salad', 'Dinner', 'Fresh seafood salad with shrimp and lemon dressing', 12, 15.00, 'base64-encoded-image-string');

------------------------------------------
Ticket TABLE

CREATE TABLE IF NOT EXISTS Ticket (
    Id INT AUTO_INCREMENT PRIMARY KEY,
    FoodId INT,
    Date DATE NOT NULL,
    Status VARCHAR(255) NOT NULL,
    Owner VARCHAR(255), -- Assuming you want to add it directly rather than modifying later
    FOREIGN KEY (FoodId) REFERENCES Food(Id)
);

-- Example JOIN query to fetch ticket details along with food information
SELECT Ticket.Id, Food.Name AS Food_name, Food.Meal, Food.Price, Food.Picture, Ticket.Date, Ticket.Status, Ticket.Owner
FROM Ticket
JOIN Food ON Ticket.FoodId = Food.Id;

------------------------------------------
User TABLE
# Create a user table.
# Role: true represents "admin", while false represents "customer".

CREATE TABLE IF NOT EXISTS User (
    Id INT AUTO_INCREMENT PRIMARY KEY,
    Name VARCHAR(255) NOT NULL,
    Email VARCHAR(255) NOT NULL UNIQUE, -- Assuming Email should be unique
    Password VARCHAR(255) NOT NULL,
    Role BOOLEAN NOT NULL -- TRUE for admin, FALSE for customer
);

# The password is the result of encrypting the string P4ssword by bcrypt with the number of stretches set to 8.
INSERT INTO User (Name, Email, Password, Role) VALUES
('admin user1', 'admin@naist.com', '$2a$08$Y6EDuwrg5lT3VLmoteDI0OQNVyqWOHvgFt5QFvs9bhIBFwok88PX.', TRUE),
('customer user1', 'customer@naist.com', '$2a$08$Y6EDuwrg5lT3VLmoteDI0OQNVyqWOHvgFt5QFvs9bhIBFwok88PX.', FALSE);

